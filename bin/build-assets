#!/bin/bash

set -e 
SCRIPT_DIR=$( cd -- "$( dirname -- "${0}" )" > /dev/null 2>&1 && pwd )

# NOTE: esbuild will copy any referenced assets from the CSS files into the CSS directory. This is fine.
#       Also note that we do not intend to hash images  or other assets at this time. esbuild could do this if needed.
echo "[ bin/build ] building CSS"
${SCRIPT_DIR}/build-css
echo "[ bin/build ] building JS"
${SCRIPT_DIR}/build-js
echo "[ bin/build ] building images"
${SCRIPT_DIR}/build-images


if [ "${RACK_ENV}" == "development" ]; then
  echo "[ bin/build ] removing jsdocs/"
  rm -rf jsdocs
  echo "[ bin/build ] Building JSDoc"
  npx jsdoc -c jsdoc.config.json -d jsdocs lib/brut-js/*.js
else
  echo "[ bin/build ] Not building JSDoc"
fi
