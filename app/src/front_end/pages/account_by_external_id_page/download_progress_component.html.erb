<% if download.ready? %>
  <div class="pa-3 bn shadow-1 br-3 bg-green-900 green-200 dib">
    <h3 class="ma-0 f-3 flex items-center gap-2">
      <span class="w-2"><%= svg("database-download-icon") %></span>
      <span>
        Data Ready
      </span>
    </h3>
    <p class="p i">
      Your data as of <%= timestamp(download.created_at, format: :full_with_tz) %> is ready to download. It'll be available here until <%= timestamp(download.delete_at, format: :full_with_tz) %>.
    </p>
    <a href="<%= DownloadsWithExternalIdHandler.routing(external_id: download.external_id) %>" class="f-3 green-200 db">
      Download
    </a>
    <%= form_tag(for: DownloadsHandler, class: "mt-4") do %>
      <%= component(ButtonComponent.new(
        size: :tiny,
        color: :blue,
        label: "Create New Download",
        icon: "database-download-icon",
        confirm: "This will delete your existing download",
      ))%>
    <p class="p i f-1">
      This will delete the currently-available download and create a new one with all your data as of this moment.
    </p>
  <% end %>
  </div>
<% else %>
  <div class="pa-3 bn shadow-1 br-3 bg-yellow-900 yellow-200 dib">
    <h3 class="ma-0 f-3 flex items-center gap-2">
      <span class="w-2 flex items-center rotating"><%= svg("loader-icon") %></span>
      <span>
        Data Being Gathered
      </span>
    </h3>
    <p class="p i mb-0">
      Your data is being assembled. Please check back.
    </p>
  </div>
<% end %>
